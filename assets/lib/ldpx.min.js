(function(){var local,ldParallax;local={};ldParallax=function(opt){var handler,update,iocfg,this$=this;opt==null&&(opt={});this.host=opt.host;if(this.host===document){this.host=null}this.watching=false;handler=function(){return this$.setOrigin()};update=function(ns){var trigger;ns==null&&(ns=[]);ns.map(function(it){return it.target._ldpx.active=it.isIntersecting});trigger=this$.list.filter(function(it){return it._ldpx.active}).length;if(trigger&&!this$.watching){(this$.host||document).addEventListener("scroll",handler)}if(!trigger&&this$.watching){(this$.host||document).removeEventListener("scroll",handler)}return this$.watching=trigger};iocfg=this.host?{root:this.host}:{};this.obs=new IntersectionObserver(update,iocfg);this.list=[];this.add(Array.from(this.host.querySelectorAll(".ldpx")));return this};ldParallax.prototype=import$(Object.create(Object.prototype),{add:function(n){var this$=this;n==null&&(n=[]);n=Array.isArray(n)?n:[n];n.map(function(it){return this$.obs.observe(it)});n.map(function(it){if(!it._ldpx){return it._ldpx={}}});this.list=this.list.concat(n);return this.setOrigin({nodes:n,force:true})},setOrigin:function(opt){var n,y,h,box,ref$,ct,ch;opt==null&&(opt={});n=this.host||document.scrollingElement;y=n.scrollTop;h=n.scrollHeight+n.getBoundingClientRect().height;if(this.host){box=this.host.getBoundingClientRect();ref$=[box.y,box.height],ct=ref$[0],ch=ref$[1]}else{ref$=[0,window.innerHeight],ct=ref$[0],ch=ref$[1]}return(opt.nodes||this.list).filter(function(it){return opt.force||it._ldpx.active}).map(function(c){var box,percent;box=c.getBoundingClientRect();percent=100*(box.y-(ct+ch))/(ct-box.height-(ct+ch));return c.style.perspectiveOrigin="50% "+percent+"%"})}});ldParallax.init=function(){var scrollers;scrollers=Array.from(document.querySelectorAll(".ldpx-scroller"));if(!scrollers.length){scrollers=[document]}return scrollers.map(function(){var ldpx;return ldpx=new ldParallax({host:document})})};if(typeof module!="undefined"&&module!==null){module.exports=ldParallax}if(window){return window.ldParallax=ldParallax}})();function import$(obj,src){var own={}.hasOwnProperty;for(var key in src)if(own.call(src,key))obj[key]=src[key];return obj}
